<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dadish-Klon – 20 Level</title>
<style>
  body { margin:0; font-family:sans-serif; background:#87ceeb; }
  #menu, #game { display:none; text-align:center; padding-top:30px; }
  button { padding:10px 20px; font-size:16px; margin:5px; cursor:pointer; }
  canvas { display:block; margin:0 auto; background:#87ceeb; border:2px solid #000; }
</style>
</head>
<body>

<div id="menu">
  <h1>Mein Dadish-Klon</h1>
  <div id="levelButtons"></div>
</div>

<div id="game">
  <canvas id="gameCanvas" width="800" height="400"></canvas>
  <p id="story"></p>
  <button onclick="showMenu()">Zurück zum Menü</button>
</div>

<script src="game.js"></script>
<script>
const menu = document.getElementById('menu');
const game = document.getElementById('game');
const levelButtonsDiv = document.getElementById('levelButtons');

for(let i=1;i<=20;i++){
  let btn = document.createElement('button');
  btn.textContent = 'Level '+i;
  btn.onclick = ()=>startGame(i);
  levelButtonsDiv.appendChild(btn);
}

function showMenu(){
  game.style.display='none';
  menu.style.display='block';
}
function startGame(level){
  menu.style.display='none';
  game.style.display='block';
  initGame(level);
}
menu.style.display='block';
</script>

</body>
</html>
let canvas = document.getElementById('gameCanvas');
let ctx = canvas.getContext('2d');

let player = { x:50, y:300, width:30, height:30, dy:0, onGround:true };
let keys = {};
let level = 1;

// Level-Daten
const levels = [];
for(let i=1;i<=20;i++){
  levels.push({
    story: `Level ${i}: Dein Abenteuer geht weiter!`,
    platforms: [
      {x:0,y:330,width:800,height:70},
      {x:150+i*5, y:250, width:100, height:20},
      {x:350+i*5, y:200, width:100, height:20}
    ],
    collectibles: [
      {x:180+i*5, y:220, width:20, height:20},
      {x:380+i*5, y:170, width:20, height:20}
    ]
  });
}

document.addEventListener('keydown', e => keys[e.key]=true);
document.addEventListener('keyup', e => keys[e.key]=false);

function initGame(lvl){
  level = lvl;
  player.x = 50; player.y = 300; player.dy=0; player.onGround=true;
  document.getElementById('story').textContent = levels[level-1].story;
  gameLoop();
}

function gameLoop(){
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

function update(){
  // Gravity
  if(!player.onGround) player.dy += 0.8;
  player.y += player.dy;

  // Boden & Plattformen
  player.onGround = false;
  levels[level-1].platforms.forEach(p=>{
    if(player.x+player.width > p.x && player.x < p.x+p.width && player.y+player.height >= p.y && player.y+player.height <= p.y+10){
      player.y = p.y - player.height;
      player.dy = 0;
      player.onGround = true;
    }
  });

  // Bewegung
  if(keys['ArrowRight']) player.x +=5;
  if(keys['ArrowLeft']) player.x -=5;
  if(keys['ArrowUp'] && player.onGround){ player.dy=-15; player.onGround=false; }

  // Sammelobjekte
  levels[level-1].collectibles = levels[level-1].collectibles.filter(c=>{
    if(player.x+player.width > c.x && player.x < c.x+c.width && player.y+player.height > c.y && player.y < c.y+c.height){
      return false; // gesammelt
    }
    return true;
  });
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Hintergrund
  ctx.fillStyle = "#87ceeb";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Plattformen
  ctx.fillStyle="#654321";
  levels[level-1].platforms.forEach(p=> ctx.fillRect(p.x,p.y,p.width,p.height));

  // Sammelobjekte
  ctx.fillStyle="#ff0";
  levels[level-1].collectibles.forEach(c=> ctx.fillRect(c.x,c.y,c.width,c.height));

  // Spieler
  ctx.fillStyle="#ff0000";
  ctx.fillRect(player.x,player.y,player.width,player.height);
}