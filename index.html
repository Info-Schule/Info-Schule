<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GGLernen Vokabeltrainer</title>
<style>
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #74b9ff, #a29bfe);
  margin:0; padding:20px;
  display:flex; flex-direction:column; align-items:center;
  min-height:100vh;
  transition: background 1s;
  color:#333;
}
h1,h2{ color:#fff; text-shadow:1px 1px 5px rgba(0,0,0,0.3);}
section{
  background: rgba(255,255,255,0.15);
  padding: 20px;
  margin: 10px;
  border-radius: 20px;
  width: 90%;
  max-width: 700px;
  backdrop-filter: blur(10px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.3);
  transition: transform 0.3s;
}
section:hover{ transform: scale(1.02);}
input,button,select{
  padding:10px; margin:5px;
  border-radius:10px;
  border:none;
  font-size:1em;
  outline:none;
}
button{
  background:#6c5ce7;
  color:white;
  cursor:pointer;
  transition:0.3s;
  box-shadow:0 5px 15px rgba(0,0,0,0.2);
}
button:hover{ background:#a29bfe; transform:scale(1.05);}
.card-container{
  perspective:1000px;
  margin:20px 0;
  position:relative;
}
.card{
  width:300px;
  height:180px;
  background:#fff;
  color:#000;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:15px;
  text-align:center;
  font-size:1.3em;
  cursor:pointer;
  transition: transform 0.6s;
  transform-style: preserve-3d;
  position:relative;
  box-shadow:0 10px 30px rgba(0,0,0,0.3);
}
.card.flipped{ transform: rotateY(180deg);}
.card .front,.card .back{
  position:absolute;
  width:100%; height:100%;
  backface-visibility:hidden;
  display:flex; align-items:center; justify-content:center;
  border-radius:15px;
}
.card .back{ transform:rotateY(180deg); background:#ffeaa7;}
.action-buttons{
  display:flex;
  flex-direction:column;
  position:absolute;
  right:-80px;
  top:0;
  gap:10px;
}
.action-buttons button{
  width:60px; height:60px;
  font-size:2em;
  padding:0;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
}
.action-buttons .correct{ background:#00b894;}
.action-buttons .wrong{ background:#d63031;}
#folderList button{
  position: relative;
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  margin-bottom: 8px;
  padding-right: 40px;
  cursor: grab;
  transition: transform 0.2s;
}
#folderList button:active{ cursor: grabbing;}
.trash{
  position:absolute;
  right:10px;
  top:50%;
  transform:translateY(-50%);
  font-size:1.2em;
  color:#d63031;
  cursor:pointer;
}
.vocab-item{ transition:0.3s;}
.vocab-item:hover{ transform:scale(1.02);}
#searchVocab{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  border-radius:10px;
  border:none;
  font-size:1em;
}

/* Avatar Styling */
#avatar{
  position:fixed;
  top:10px; right:10px;
  font-size:2em;
  background: #fff;
  border-radius:50%;
  padding:10px;
  box-shadow:0 5px 20px rgba(0,0,0,0.3);
  cursor:pointer;
}
#profileCard{
  position:fixed;
  top:70px; right:10px;
  background: rgba(255,255,255,0.95);
  padding:15px;
  border-radius:15px;
  box-shadow:0 5px 20px rgba(0,0,0,0.3);
  display:none;
  flex-direction: column;
  min-width:200px;
  z-index:10;
}
</style>
</head>
<body>

<h1>GGLernen Vokabeltrainer</h1>

<div id="avatar">üë¶üèª</div>
<div id="profileCard">
  <strong>Name:</strong> <span id="profileName"></span><br>
  <strong>Level:</strong> <span id="profileLevel"></span><br>
  <strong>Streak:</strong> <span id="profileStreak"></span><br>
  <strong>Fortschritt:</strong> <span id="profileProgress"></span>
</div>

<section>
  <h2>Konto</h2>
  <input type="text" id="usernameInput" placeholder="Dein Name">
  <button onclick="saveUsername()">Speichern</button>
</section>

<section>
  <h2>Ordner</h2>
  <input type="text" id="newFolderName" placeholder="Neuen Ordner erstellen">
  <button onclick="createFolder()">Erstellen</button>
  <div id="folderList"></div>
</section>

<section id="trainerSection" style="display:none; position:relative;">
  <h2 id="folderTitle"></h2>
  <div class="card-container">
    <div class="card" id="card" onclick="flipCard()">
      <div class="front" id="cardFront"></div>
      <div class="back" id="cardBack"></div>
    </div>
    <div class="action-buttons">
      <button class="correct" onclick="answer(true)">‚úÖ</button>
      <button class="wrong" onclick="answer(false)">‚ùå</button>
    </div>
  </div>
  <div>
    <input type="text" id="backInput" placeholder="Deutsch">
    <input type="text" id="frontInput" placeholder="Fremdsprache">
    <button onclick="addVocab()">Hinzuf√ºgen</button>
  </div>
  <input type="text" id="searchVocab" placeholder="Vokabeln suchen" oninput="renderVocabList()">
  <div id="vocabList"></div>
</section>

<script>
// --- Account ---
let username = localStorage.getItem('username') || '';
let streak = JSON.parse(localStorage.getItem('streak')) || 0;
document.getElementById('usernameInput').value = username;

function saveUsername() {
  username = document.getElementById('usernameInput').value.trim();
  localStorage.setItem('username', username);
  updateAccountInfo();
}

function updateAccountInfo() {
  document.getElementById('profileName').innerText = username || 'Unbekannt';
  document.getElementById('profileStreak').innerText = streak + ' Tage';
  updateProgressDisplay();
}

// --- Avatar ---
const avatar = document.getElementById('avatar');
const profileCard = document.getElementById('profileCard');
avatar.addEventListener('click', () => {
  profileCard.style.display = profileCard.style.display==='flex'?'none':'flex';
});

// --- Ordner ---
let folders = JSON.parse(localStorage.getItem('folders')) || {};
let folderOrder = JSON.parse(localStorage.getItem('folderOrder')) || Object.keys(folders);
let currentFolder='';
let vocabList=[];
let currentIndex=0;
let flipped=false;

function saveFolders(){
  localStorage.setItem('folders',JSON.stringify(folders));
  localStorage.setItem('folderOrder',JSON.stringify(folderOrder));
}

function renderFolders(){
  const list=document.getElementById('folderList');
  list.innerHTML='';
  folderOrder.forEach(name=>{
    if(!folders[name]) return;
    let btn=document.createElement('button');
    btn.innerText=name;
    btn.setAttribute('draggable',true);
    btn.ondragstart=e=>{e.dataTransfer.setData('text/plain',name);}
    btn.ondragover=e=>e.preventDefault();
    btn.ondrop=e=>{
      const draggedName=e.dataTransfer.getData('text/plain');
      const fromIndex=folderOrder.indexOf(draggedName);
      const toIndex=folderOrder.indexOf(name);
      folderOrder.splice(fromIndex,1);
      folderOrder.splice(toIndex,0,draggedName);
      saveFolders(); renderFolders();
    };
    btn.onclick=()=>openFolder(name);
    let trash=document.createElement('span');
    trash.className='trash';
    trash.innerText='üóëÔ∏è';
    trash.onclick=e=>{
      e.stopPropagation();
      delete folders[name];
      folderOrder=folderOrder.filter(f=>f!==name);
      saveFolders();
      renderFolders();
    };
    btn.appendChild(trash);
    list.appendChild(btn);
  });
}

function createFolder(){
  let name=document.getElementById('newFolderName').value.trim();
  if(name && !folders[name]){
    folders[name]=[];
    folderOrder.push(name);
    saveFolders();
    renderFolders();
    document.getElementById('newFolderName').value='';
  }
}

function openFolder(name){
  currentFolder=name;
  vocabList=folders[name];
  document.getElementById('trainerSection').style.display='block';
  document.getElementById('folderTitle').innerText=name;
  currentIndex=0; flipped=false;
  showCard();
  renderVocabList();
}

// --- Trainer ---
function showCard(){
  if(vocabList.length===0){
    document.getElementById('cardFront').innerText='Keine Vokabeln';
    document.getElementById('cardBack').innerText='';
    return;
  }
  document.getElementById('cardFront').innerText=vocabList[currentIndex].front;
  document.getElementById('cardBack').innerText=vocabList[currentIndex].back;
  flipped=false;
  document.getElementById('card').classList.remove('flipped');
}

function flipCard(){
  if(vocabList.length===0) return;
  flipped=!flipped;
  document.getElementById('card').classList.toggle('flipped');
}

function addVocab(){
  const front=document.getElementById('frontInput').value.trim();
  const back=document.getElementById('backInput').value.trim();
  if(front && back){
    vocabList.push({front,back,right:0,wrong:0});
    folders[currentFolder]=vocabList;
    saveFolders();
    document.getElementById('frontInput').value='';
    document.getElementById('backInput').value='';
    showCard();
    renderVocabList();
  }
}

function answer(isRight){
  if(vocabList.length===0) return;
  if(isRight) vocabList[currentIndex].right++;
  else vocabList[currentIndex].wrong++;
  folders[currentFolder]=vocabList;
  saveFolders();
  nextCard();
  renderVocabList();
  streak++;
  localStorage.setItem('streak',JSON.stringify(streak));
  updateAccountInfo();
}

function nextCard(){
  currentIndex++;
  if(currentIndex>=vocabList.length) currentIndex=0;
  showCard();
}

function renderVocabList(){
  const container=document.getElementById('vocabList');
  const search=document.getElementById('searchVocab').value.toLowerCase();
  container.innerHTML='';
  vocabList.sort((a,b)=>(b.wrong/(b.right+b.wrong||1))-(a.wrong/(a.right+a.wrong||1)));
  vocabList.forEach(v=>{
    if(v.front.toLowerCase().includes(search) || v.back.toLowerCase().includes(search)){
      let percent=Math.round((v.right/(v.right+v.wrong||1))*100);
      const div=document.createElement('div');
      div.className='vocab-item';
     